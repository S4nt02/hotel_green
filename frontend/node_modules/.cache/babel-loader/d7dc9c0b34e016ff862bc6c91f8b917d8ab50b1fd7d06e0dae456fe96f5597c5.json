{"ast":null,"code":"import{useEffect,useState}from\"react\";import{API_URL}from\"../../url\";import{jsxs as _jsxs,jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";function CheckOut(_ref){let{idCheckOut}=_ref;const[informacoes,setInformacoes]=useState({});const[horario,setHorario]=useState(\"\");const[desconto,setDesconto]=useState(0);const[formaPagamento,setFormaPagamento]=useState(\"Dinheiro\");const buscarInformacoes=async()=>{const buscar=await fetch(`${API_URL}/api/buscarCheckOut`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({id:idCheckOut})});const dados=await buscar.json();// Se consumo veio como string JSON\nif(typeof dados.consumo==='string'){try{dados.consumo=JSON.parse(dados.consumo);}catch(e){dados.consumo=[];}}console.log(dados);setInformacoes(dados);};const obterData=()=>{const data=new Date();const dia=String(data.getDate()).padStart(2,'0');const mes=String(data.getMonth()+1).padStart(2,'0');const ano=data.getFullYear();const horas=String(data.getHours()).padStart(2,'0');const minutos=String(data.getMinutes()).padStart(2,'0');const dataFormatada=`${dia}/${mes}/${ano} ${horas}:${minutos}`;setHorario(dataFormatada);};useEffect(()=>{console.log(idCheckOut);buscarInformacoes();obterData();},[]);const agruparConsumo=()=>{const agrupado={};if(!informacoes.consumo)return agrupado;informacoes.consumo.forEach(item=>{const categoria=item.nomeCategoria||'Outros';if(!agrupado[categoria])agrupado[categoria]=[];agrupado[categoria].push(item);});return agrupado;};const calcularTotalConsumo=()=>{if(!informacoes.consumo)return 0;return informacoes.consumo.reduce((total,item)=>total+item.quantidade*item.preco,0);};const totalConsumo=calcularTotalConsumo();const subtotal=(informacoes.vlDiaria||0)*(informacoes.periodo||1)+totalConsumo;const totalFinal=subtotal-desconto;const consumoPorCategoria=agruparConsumo();return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Quarto: \",informacoes.quarto]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Unidade: \",informacoes.nomeUnidade]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Hospede Principal: \",informacoes.nomeHospede]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Entrada: \",informacoes.horarioEntrada]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Sa\\xEDda: \",horario]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Periodo: \",informacoes.periodo]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Valor Diaria: \",informacoes.vlDiaria]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Cosnumo\"}),Object.keys(consumoPorCategoria).map(categoria=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:categoria}),consumoPorCategoria[categoria].map((item,i)=>/*#__PURE__*/_jsxs(\"p\",{children:[item.item,\" \\u2013 \",item.quantidade,\" x R$ \",item.preco,\" = R$ \",(item.quantidade*item.preco).toFixed(2)]},i))]},categoria))]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"h3\",{children:[\"Sub-Total: R$ \",subtotal.toFixed(2)]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Desconto\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:desconto,onChange:e=>setDesconto(Number(e.target.value))})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"h3\",{children:[\"Total com Desconto: R$ \",totalFinal.toFixed(2)]})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Forma de pagamento\"}),/*#__PURE__*/_jsxs(\"select\",{value:formaPagamento,onChange:e=>setFormaPagamento(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"Dinheiro\",children:\"A vista\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Cart\\xE3o\",children:\"Faturado\"})]})]})]})]})]})});}export default CheckOut;","map":{"version":3,"names":["useEffect","useState","API_URL","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","CheckOut","_ref","idCheckOut","informacoes","setInformacoes","horario","setHorario","desconto","setDesconto","formaPagamento","setFormaPagamento","buscarInformacoes","buscar","fetch","method","headers","body","JSON","stringify","id","dados","json","consumo","parse","e","console","log","obterData","data","Date","dia","String","getDate","padStart","mes","getMonth","ano","getFullYear","horas","getHours","minutos","getMinutes","dataFormatada","agruparConsumo","agrupado","forEach","item","categoria","nomeCategoria","push","calcularTotalConsumo","reduce","total","quantidade","preco","totalConsumo","subtotal","vlDiaria","periodo","totalFinal","consumoPorCategoria","children","quarto","nomeUnidade","nomeHospede","horarioEntrada","Object","keys","map","i","toFixed","type","value","onChange","Number","target"],"sources":["C:/Users/andre/hotel_green/frontend/src/componetes/checkOut/checkOut.js"],"sourcesContent":["import { useEffect, useState } from \"react\"\r\nimport { API_URL } from \"../../url\"\r\n\r\nfunction CheckOut ({idCheckOut}) {\r\n\r\n    const [informacoes, setInformacoes] = useState({})\r\n    const [horario, setHorario] = useState(\"\")\r\n    const [desconto, setDesconto] = useState(0)\r\n    const [formaPagamento, setFormaPagamento] = useState(\"Dinheiro\")\r\n\r\n    const buscarInformacoes = async () => {\r\n        const buscar = await fetch(`${API_URL}/api/buscarCheckOut`, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ id: idCheckOut })\r\n        })\r\n\r\n        const dados = await buscar.json()\r\n\r\n        // Se consumo veio como string JSON\r\n        if (typeof dados.consumo === 'string') {\r\n            try {\r\n                dados.consumo = JSON.parse(dados.consumo)\r\n            } catch (e) {\r\n                dados.consumo = []\r\n            }\r\n        }\r\n        console.log(dados)\r\n        setInformacoes(dados)\r\n    }\r\n\r\n    const obterData = () => {\r\n        const data = new Date()\r\n        const dia = String(data.getDate()).padStart(2, '0')\r\n        const mes = String(data.getMonth() + 1).padStart(2, '0')\r\n        const ano = data.getFullYear()\r\n        const horas = String(data.getHours()).padStart(2, '0')\r\n        const minutos = String(data.getMinutes()).padStart(2, '0')\r\n\r\n        const dataFormatada = `${dia}/${mes}/${ano} ${horas}:${minutos}`\r\n        setHorario(dataFormatada)\r\n    }\r\n\r\n    useEffect(() => {\r\n        console.log(idCheckOut)\r\n        buscarInformacoes()\r\n        obterData()\r\n    }, [])\r\n\r\n    const agruparConsumo = () => {\r\n        const agrupado = {}\r\n\r\n        if (!informacoes.consumo) return agrupado\r\n\r\n        informacoes.consumo.forEach(item => {\r\n            const categoria = item.nomeCategoria || 'Outros'\r\n            if (!agrupado[categoria]) agrupado[categoria] = []\r\n            agrupado[categoria].push(item)\r\n        })\r\n\r\n        return agrupado\r\n    }\r\n\r\n    const calcularTotalConsumo = () => {\r\n        if (!informacoes.consumo) return 0\r\n        return informacoes.consumo.reduce((total, item) => total + (item.quantidade * item.preco), 0)\r\n    }\r\n\r\n    const totalConsumo = calcularTotalConsumo()\r\n    const subtotal = (informacoes.vlDiaria || 0) * (informacoes.periodo || 1) + totalConsumo\r\n    const totalFinal = subtotal - desconto\r\n\r\n    const consumoPorCategoria = agruparConsumo()\r\n\r\n    return(\r\n        <>\r\n            <div>\r\n                <div>\r\n                    <p>Quarto: {informacoes.quarto}</p>\r\n                    <p>Unidade: {informacoes.nomeUnidade}</p>\r\n                </div>\r\n                <div>\r\n                    <p>Hospede Principal: {informacoes.nomeHospede}</p>\r\n                    <p>Entrada: {informacoes.horarioEntrada}</p>\r\n                    <p>Saída: {horario}</p>\r\n                </div>\r\n                <div>\r\n                    <p>Periodo: {informacoes.periodo}</p>\r\n                    <p>Valor Diaria: {informacoes.vlDiaria}</p>\r\n\r\n                    <div>\r\n                        <h3>Cosnumo</h3>\r\n                        {Object.keys(consumoPorCategoria).map(categoria => (\r\n                            <div key={categoria}>\r\n                                <h4>{categoria}</h4>\r\n                                {consumoPorCategoria[categoria].map((item, i) => (\r\n                                    <p key={i}>\r\n                                        {item.item} – {item.quantidade} x R$ {item.preco} = R$ {(item.quantidade * item.preco).toFixed(2)}\r\n                                    </p>\r\n                                ))}\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                    <div>\r\n                        <div>\r\n                            <h3>Sub-Total: R$ {subtotal.toFixed(2)}</h3>\r\n                        </div>\r\n                        <div>\r\n                            <label>Desconto</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={desconto}\r\n                                onChange={e => setDesconto(Number(e.target.value))}\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <h3>Total com Desconto: R$ {totalFinal.toFixed(2)}</h3>\r\n                        </div>\r\n                        <div>\r\n                            <h3>Forma de pagamento</h3>\r\n                            <select value={formaPagamento} onChange={e => setFormaPagamento(e.target.value)}>\r\n                                <option value=\"Dinheiro\">A vista</option>\r\n                                <option value=\"Cartão\">Faturado</option>\r\n                            </select>                      \r\n                            \r\n\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default CheckOut"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}