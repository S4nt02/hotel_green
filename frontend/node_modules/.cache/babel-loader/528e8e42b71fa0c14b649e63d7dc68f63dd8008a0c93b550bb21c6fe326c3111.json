{"ast":null,"code":"import{useEffect,useState}from\"react\";import HeaderComponente from\"../../componetes/header/headerComponente\";import{API_URL}from\"../../url\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Hospedes(){const[infos,setInfos]=useState([]);const[unidades,setUnidades]=useState([]);const[unidadeSelecionada,setUnidadeSelecionada]=useState(\"\");const[dadosRelatorio,setDadosRelatorio]=useState([]);const buscarHospedes=async()=>{const resultado=await fetch(`${API_URL}/api/buscarHospedes`);const dados=await resultado.json();setInfos(dados);setDadosRelatorio(dados);};const buscarUnidade=async()=>{try{const buscarUnidade=await fetch(`${API_URL}/api/buscarUnidade`);const dados=await buscarUnidade.json();setUnidades(dados);}catch(erro){console.error(\"Erro ao buscar unidades:\",erro);}};const removerValoresVazios=array=>{return array.filter(item=>item!==\"\");};const converterData=dataCon=>{const dataFormatada=new Date(dataCon).toLocaleDateString(\"pt-BR\");return dataFormatada;};const filtrarAcomodacoes=lista=>{return lista.filter(acomodacao=>{var _acomodacao$unidade;const idUnidadeAcomodacao=String(acomodacao.idUnidade||((_acomodacao$unidade=acomodacao.unidade)===null||_acomodacao$unidade===void 0?void 0:_acomodacao$unidade.id)||\"\");return unidadeSelecionada===\"\"||idUnidadeAcomodacao===unidadeSelecionada;});};const baixarRelatorio=async()=>{const response=await fetch(`${API_URL}/api/geraRelatorioHospedes`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(dadosRelatorio)});const blob=await response.blob();const url=window.URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;link.download='relatorio.pdf';link.click();};useEffect(()=>{buscarHospedes();buscarUnidade();});useEffect(()=>{setDadosRelatorio(filtrarAcomodacoes(infos));},[unidadeSelecionada]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(HeaderComponente,{}),/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Unidade\"}),/*#__PURE__*/_jsxs(\"select\",{value:unidadeSelecionada,onChange:e=>setUnidadeSelecionada(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:'',children:\"Todas unidades\"}),unidades.map(unidade=>/*#__PURE__*/_jsx(\"option\",{value:unidade.id,children:unidade.nomeUnidade},unidade.id))]}),/*#__PURE__*/_jsx(\"button\",{onClick:baixarRelatorio,children:\"Baixar relatorio\"}),dadosRelatorio.map(info=>/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Reserva: \",info.id]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Data de checkIN: \",info.horarioEntrada]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Data de sa\\xEDda: \",converterData(info.checkOut)]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Unidade: \",info.nomeUnidade]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Quarto: \",info.numAcomodacao]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Hospede Principal: \",info.hospede]}),/*#__PURE__*/_jsx(\"p\",{children:\"Acompanhantes:\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Adultos:\"}),removerValoresVazios(info.acompanhantesAdultos).map((acompanhante,index)=>/*#__PURE__*/_jsx(\"p\",{children:acompanhante},index)),/*#__PURE__*/_jsx(\"p\",{children:\"Crian\\xE7as:\"}),removerValoresVazios(info.acompanhantesCriancas).map((acompanhante,index)=>/*#__PURE__*/_jsx(\"p\",{children:acompanhante},index))]},info.id)}))]})]});}export default Hospedes;","map":{"version":3,"names":["useEffect","useState","HeaderComponente","API_URL","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Hospedes","infos","setInfos","unidades","setUnidades","unidadeSelecionada","setUnidadeSelecionada","dadosRelatorio","setDadosRelatorio","buscarHospedes","resultado","fetch","dados","json","buscarUnidade","erro","console","error","removerValoresVazios","array","filter","item","converterData","dataCon","dataFormatada","Date","toLocaleDateString","filtrarAcomodacoes","lista","acomodacao","_acomodacao$unidade","idUnidadeAcomodacao","String","idUnidade","unidade","id","baixarRelatorio","response","method","headers","body","JSON","stringify","blob","url","window","URL","createObjectURL","link","document","createElement","href","download","click","children","value","onChange","e","target","map","nomeUnidade","onClick","info","horarioEntrada","checkOut","numAcomodacao","hospede","acompanhantesAdultos","acompanhante","index","acompanhantesCriancas"],"sources":["C:/Users/andre/hotel_green/frontend/src/pages/hospedes/hospedes.js"],"sourcesContent":["import { useEffect, useState } from \"react\"\r\nimport HeaderComponente from \"../../componetes/header/headerComponente\"\r\nimport { API_URL } from \"../../url\"\r\n\r\nfunction Hospedes () {\r\n\r\n    const [infos, setInfos] = useState([])\r\n    const [unidades, setUnidades] = useState([])\r\n    const [unidadeSelecionada, setUnidadeSelecionada] = useState(\"\")\r\n    const [dadosRelatorio, setDadosRelatorio] = useState([])\r\n\r\n    const buscarHospedes = async () => {\r\n        const resultado = await fetch(`${API_URL}/api/buscarHospedes`)\r\n        const dados = await resultado.json()\r\n\r\n        setInfos(dados)\r\n        setDadosRelatorio(dados)\r\n    }\r\n\r\n    const buscarUnidade = async () => {\r\n        try {\r\n            const buscarUnidade = await fetch(`${API_URL}/api/buscarUnidade`);\r\n            const dados = await buscarUnidade.json();\r\n\r\n            setUnidades(dados);\r\n        } catch (erro) {\r\n            console.error(\"Erro ao buscar unidades:\", erro);\r\n        }\r\n    };\r\n\r\n    const removerValoresVazios = (array) => {\r\n        return array.filter(item => item !== \"\")\r\n    }\r\n\r\n    const converterData = (dataCon) => {\r\n        const dataFormatada = new Date(dataCon).toLocaleDateString(\"pt-BR\")\r\n        return dataFormatada\r\n    }\r\n\r\n    const filtrarAcomodacoes = (lista) => {\r\n        return lista.filter(acomodacao => {\r\n            const idUnidadeAcomodacao = String(acomodacao.idUnidade || acomodacao.unidade?.id || \"\")\r\n            return unidadeSelecionada === \"\" || idUnidadeAcomodacao === unidadeSelecionada\r\n        })\r\n    }\r\n\r\n    const baixarRelatorio = async () => {\r\n        const response = await fetch(`${API_URL}/api/geraRelatorioHospedes`, {\r\n            method: 'POST',\r\n            headers: {\r\n            'Content-Type': 'application/json',\r\n            },\r\n            body: JSON.stringify(dadosRelatorio),\r\n        });\r\n\r\n        const blob = await response.blob();\r\n        const url = window.URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.download = 'relatorio.pdf';\r\n        link.click();\r\n    }\r\n\r\n    useEffect(() => {\r\n        buscarHospedes()\r\n        buscarUnidade()\r\n    })\r\n\r\n    useEffect(() => {\r\n        setDadosRelatorio(filtrarAcomodacoes(infos))\r\n    }, [unidadeSelecionada])\r\n\r\n    return(\r\n        <>\r\n            <HeaderComponente/>\r\n            <main>\r\n                <label>Unidade</label>\r\n                <select\r\n                    value={unidadeSelecionada}\r\n                    onChange={(e) => setUnidadeSelecionada(e.target.value)}\r\n                >\r\n                    <option value={''}>Todas unidades</option>\r\n                    {unidades.map(unidade => (\r\n                        <option key={unidade.id} value={unidade.id}>{unidade.nomeUnidade}</option>\r\n                    ))}\r\n                </select>\r\n                <button onClick={baixarRelatorio}>Baixar relatorio</button>\r\n                {dadosRelatorio.map(info => (\r\n                    <>\r\n                        <div key={info.id}>\r\n                            <p>Reserva: {info.id}</p>\r\n                            <p>Data de checkIN: {info.horarioEntrada}</p>\r\n                            <p>Data de saída: {converterData(info.checkOut)}</p>\r\n                            <p>Unidade: {info.nomeUnidade}</p>\r\n                            <p>Quarto: {info.numAcomodacao}</p>\r\n                            <p>Hospede Principal: {info.hospede}</p>\r\n                            <p>Acompanhantes:</p>\r\n                            <p>Adultos:</p>\r\n                            {removerValoresVazios(info.acompanhantesAdultos).map((acompanhante, index) => (\r\n                                <p key={index}>{acompanhante}</p>\r\n                            ))}\r\n                            <p>Crianças:</p>\r\n                            {removerValoresVazios(info.acompanhantesCriancas).map((acompanhante, index) => (\r\n                                <p key={index}>{acompanhante}</p>\r\n                            ))}\r\n                        </div>\r\n                    </>\r\n                ))}\r\n            </main>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Hospedes"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}