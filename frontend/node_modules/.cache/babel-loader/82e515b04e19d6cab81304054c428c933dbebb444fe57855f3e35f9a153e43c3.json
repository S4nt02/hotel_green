{"ast":null,"code":"import{useEffect,useState}from\"react\";import{API_URL}from\"../../url\";import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";function CheckOut(_ref){let{idCheckOut}=_ref;const[informacoes,setInformacoes]=useState({});const[horario,setHorario]=useState(\"\");const[desconto,setDesconto]=useState(0);const[formaPagamento,setFormaPagamento]=useState(\"Dinheiro\");const buscarInformacoes=async()=>{const buscar=await fetch(`${API_URL}/api/buscarCheckOut`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({id:idCheckOut})});const resultado=await buscar.json();// Verifica se o resultado é um array\nconst dados=Array.isArray(resultado)?resultado[0]:resultado;if(typeof dados.consumo==='string'){try{const parsed=JSON.parse(dados.consumo);dados.consumo=Array.isArray(parsed)?parsed:[];}catch{dados.consumo=[];}}setInformacoes(dados);};const obterData=()=>{const data=new Date();const dia=String(data.getDate()).padStart(2,'0');const mes=String(data.getMonth()+1).padStart(2,'0');const ano=data.getFullYear();const horas=String(data.getHours()).padStart(2,'0');const minutos=String(data.getMinutes()).padStart(2,'0');const dataFormatada=`${dia}/${mes}/${ano} ${horas}:${minutos}`;setHorario(dataFormatada);};useEffect(()=>{buscarInformacoes();obterData();},[]);const agruparConsumo=()=>{const agrupado={};if(!informacoes.consumo)return agrupado;informacoes.consumo.forEach(item=>{const categoria=item.nomeCategoria||'Outros';if(!agrupado[categoria])agrupado[categoria]=[];agrupado[categoria].push(item);});return agrupado;};const calcularTotalConsumo=()=>{if(!informacoes.consumo)return 0;return informacoes.consumo.reduce((total,item)=>total+item.quantidade*item.preco,0);};const totalConsumo=calcularTotalConsumo();const vlDiaria=Number(informacoes.vlDiaria||0);const periodo=Number(informacoes.periodo||1);const subtotal=vlDiaria*periodo+totalConsumo;const totalFinal=subtotal-desconto;const consumoPorCategoria=agruparConsumo();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Quarto: \",informacoes.quarto]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Unidade: \",informacoes.nomeUnidade]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Hospede Principal: \",informacoes.nomeHospede]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Entrada: \",informacoes.horarioEntrada]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Sa\\xEDda: \",horario]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Per\\xEDodo: \",informacoes.periodo]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Valor Di\\xE1ria: R$ \",vlDiaria.toFixed(2)]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Consumo\"}),Object.keys(consumoPorCategoria).map(categoria=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:categoria}),consumoPorCategoria[categoria].map((item,i)=>/*#__PURE__*/_jsxs(\"p\",{children:[item.item,\" \\u2013 \",item.quantidade,\" x R$ \",item.preco.toFixed(2),\" = R$ \",(item.quantidade*item.preco).toFixed(2)]},i))]},categoria))]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Sub-Total: R$ \",subtotal.toFixed(2)]}),/*#__PURE__*/_jsx(\"label\",{children:\"Desconto\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:desconto,onChange:e=>setDesconto(Number(e.target.value))}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Total com Desconto: R$ \",totalFinal.toFixed(2)]}),/*#__PURE__*/_jsx(\"h3\",{children:\"Forma de pagamento\"}),/*#__PURE__*/_jsxs(\"select\",{value:formaPagamento,onChange:e=>setFormaPagamento(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"Dinheiro\",children:\"\\xC0 vista\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Cart\\xE3o\",children:\"Faturado\"})]})]})]})]});}export default CheckOut;","map":{"version":3,"names":["useEffect","useState","API_URL","jsxs","_jsxs","jsx","_jsx","CheckOut","_ref","idCheckOut","informacoes","setInformacoes","horario","setHorario","desconto","setDesconto","formaPagamento","setFormaPagamento","buscarInformacoes","buscar","fetch","method","headers","body","JSON","stringify","id","resultado","json","dados","Array","isArray","consumo","parsed","parse","obterData","data","Date","dia","String","getDate","padStart","mes","getMonth","ano","getFullYear","horas","getHours","minutos","getMinutes","dataFormatada","agruparConsumo","agrupado","forEach","item","categoria","nomeCategoria","push","calcularTotalConsumo","reduce","total","quantidade","preco","totalConsumo","vlDiaria","Number","periodo","subtotal","totalFinal","consumoPorCategoria","children","quarto","nomeUnidade","nomeHospede","horarioEntrada","toFixed","Object","keys","map","i","type","value","onChange","e","target"],"sources":["C:/Users/andre/hotel_green/frontend/src/componetes/checkOut/checkOut.js"],"sourcesContent":["import { useEffect, useState } from \"react\"\r\nimport { API_URL } from \"../../url\"\r\n\r\nfunction CheckOut({ idCheckOut }) {\r\n    const [informacoes, setInformacoes] = useState({})\r\n    const [horario, setHorario] = useState(\"\")\r\n    const [desconto, setDesconto] = useState(0)\r\n    const [formaPagamento, setFormaPagamento] = useState(\"Dinheiro\")\r\n\r\n    const buscarInformacoes = async () => {\r\n        const buscar = await fetch(`${API_URL}/api/buscarCheckOut`, {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ id: idCheckOut })\r\n        })\r\n\r\n        const resultado = await buscar.json()\r\n\r\n        // Verifica se o resultado é um array\r\n        const dados = Array.isArray(resultado) ? resultado[0] : resultado\r\n\r\n        if (typeof dados.consumo === 'string') {\r\n            try {\r\n                const parsed = JSON.parse(dados.consumo)\r\n                dados.consumo = Array.isArray(parsed) ? parsed : []\r\n            } catch {\r\n                dados.consumo = []\r\n            }\r\n        }\r\n\r\n        setInformacoes(dados)\r\n    }\r\n\r\n    const obterData = () => {\r\n        const data = new Date()\r\n        const dia = String(data.getDate()).padStart(2, '0')\r\n        const mes = String(data.getMonth() + 1).padStart(2, '0')\r\n        const ano = data.getFullYear()\r\n        const horas = String(data.getHours()).padStart(2, '0')\r\n        const minutos = String(data.getMinutes()).padStart(2, '0')\r\n\r\n        const dataFormatada = `${dia}/${mes}/${ano} ${horas}:${minutos}`\r\n        setHorario(dataFormatada)\r\n    }\r\n\r\n    useEffect(() => {\r\n        buscarInformacoes()\r\n        obterData()\r\n    }, [])\r\n\r\n    const agruparConsumo = () => {\r\n        const agrupado = {}\r\n\r\n        if (!informacoes.consumo) return agrupado\r\n\r\n        informacoes.consumo.forEach(item => {\r\n            const categoria = item.nomeCategoria || 'Outros'\r\n            if (!agrupado[categoria]) agrupado[categoria] = []\r\n            agrupado[categoria].push(item)\r\n        })\r\n\r\n        return agrupado\r\n    }\r\n\r\n    const calcularTotalConsumo = () => {\r\n        if (!informacoes.consumo) return 0\r\n        return informacoes.consumo.reduce((total, item) => total + (item.quantidade * item.preco), 0)\r\n    }\r\n\r\n    const totalConsumo = calcularTotalConsumo()\r\n    const vlDiaria = Number(informacoes.vlDiaria || 0)\r\n    const periodo = Number(informacoes.periodo || 1)\r\n    const subtotal = vlDiaria * periodo + totalConsumo\r\n    const totalFinal = subtotal - desconto\r\n\r\n    const consumoPorCategoria = agruparConsumo()\r\n\r\n    return (\r\n        <div>\r\n            <div>\r\n                <p>Quarto: {informacoes.quarto}</p>\r\n                <p>Unidade: {informacoes.nomeUnidade}</p>\r\n            </div>\r\n            <div>\r\n                <p>Hospede Principal: {informacoes.nomeHospede}</p>\r\n                <p>Entrada: {informacoes.horarioEntrada}</p>\r\n                <p>Saída: {horario}</p>\r\n            </div>\r\n            <div>\r\n                <p>Período: {informacoes.periodo}</p>\r\n                <p>Valor Diária: R$ {vlDiaria.toFixed(2)}</p>\r\n\r\n                <div>\r\n                    <h3>Consumo</h3>\r\n                    {Object.keys(consumoPorCategoria).map(categoria => (\r\n                        <div key={categoria}>\r\n                            <h4>{categoria}</h4>\r\n                            {consumoPorCategoria[categoria].map((item, i) => (\r\n                                <p key={i}>\r\n                                    {item.item} – {item.quantidade} x R$ {item.preco.toFixed(2)} = R$ {(item.quantidade * item.preco).toFixed(2)}\r\n                                </p>\r\n                            ))}\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                <div>\r\n                    <h3>Sub-Total: R$ {subtotal.toFixed(2)}</h3>\r\n\r\n                    <label>Desconto</label>\r\n                    <input\r\n                        type=\"number\"\r\n                        value={desconto}\r\n                        onChange={e => setDesconto(Number(e.target.value))}\r\n                    />\r\n\r\n                    <h3>Total com Desconto: R$ {totalFinal.toFixed(2)}</h3>\r\n\r\n                    <h3>Forma de pagamento</h3>\r\n                    <select value={formaPagamento} onChange={e => setFormaPagamento(e.target.value)}>\r\n                        <option value=\"Dinheiro\">À vista</option>\r\n                        <option value=\"Cartão\">Faturado</option>\r\n                    </select>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default CheckOut\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}