{"ast":null,"code":"import React,{createContext,useState,useContext,useEffect}from'react';import{API_URL}from'../url';// Criando o contexto\nimport{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();// Provedor do contexto\nexport const AuthProvider=_ref=>{let{children}=_ref;const[usuario,setUsuario]=useState(null);const[autorizacao,setAutorizacao]=useState(null);const[carregando,setCarregando]=useState(true);// Função para verificar se o usuário está logado\nconst verificarLogin=async()=>{try{const resposta=await fetch(`${API_URL}/auth/verify`,{method:'GET',credentials:'include'// Isso garante que o cookie de sessão seja enviado\n});const data=await resposta.json();if(data.autenticado){setUsuario(data.usuario);setAutorizacao(data.autorizacao);}else{setUsuario(null);setAutorizacao(null);}}catch(erro){console.error('Erro ao verificar login:',erro);setUsuario(null);setAutorizacao(null);}finally{setCarregando(false);}};// Verificando o login na montagem do componente\nuseEffect(()=>{verificarLogin();},[]);// Função para fazer o login\nconst login=async(email,senha)=>{try{const resposta=await fetch(`${API_URL}/login`,{method:'POST',headers:{'Content-Type':'application/json'},credentials:'include',// Garante que o cookie de sessão seja enviado\nbody:JSON.stringify({email,senha})});const data=await resposta.json();if(data.logado){setUsuario(data.usuario);}else{console.error('Falha no login');}}catch(erro){console.error('Erro no login:',erro);}};// Função para fazer o logout\nconst logout=()=>{setUsuario(null);fetch(`${API_URL}/logout`,{method:'POST',credentials:'include'// Garante que o cookie de sessão seja enviado\n});};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{usuario,login,logout,carregando,autorizacao},children:children});};// Hook para consumir o contexto\nexport const useAuth=()=>{return useContext(AuthContext);};","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","API_URL","jsx","_jsx","AuthContext","AuthProvider","_ref","children","usuario","setUsuario","autorizacao","setAutorizacao","carregando","setCarregando","verificarLogin","resposta","fetch","method","credentials","data","json","autenticado","erro","console","error","login","email","senha","headers","body","JSON","stringify","logado","logout","Provider","value","useAuth"],"sources":["C:/Users/andre/hotel_green/frontend/src/context/authContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from 'react';\r\nimport { API_URL } from '../url';\r\n\r\n// Criando o contexto\r\nconst AuthContext = createContext();\r\n\r\n// Provedor do contexto\r\nexport const AuthProvider = ({ children }) => {\r\n  const [usuario, setUsuario] = useState(null);\r\n  const [autorizacao, setAutorizacao] = useState(null)\r\n  const [carregando, setCarregando] = useState(true);\r\n\r\n  // Função para verificar se o usuário está logado\r\n  const verificarLogin = async () => {\r\n    try {\r\n      const resposta = await fetch(`${API_URL}/auth/verify`, {\r\n        method: 'GET',\r\n        credentials: 'include', // Isso garante que o cookie de sessão seja enviado\r\n      });\r\n      const data = await resposta.json();\r\n      if (data.autenticado) {\r\n        setUsuario(data.usuario);\r\n        setAutorizacao(data.autorizacao)\r\n      } else {\r\n        setUsuario(null);\r\n        setAutorizacao(null)\r\n      }\r\n    } catch (erro) {\r\n      console.error('Erro ao verificar login:', erro);\r\n      setUsuario(null);\r\n      setAutorizacao(null)\r\n    } finally {\r\n      setCarregando(false);\r\n    }\r\n  };\r\n\r\n  // Verificando o login na montagem do componente\r\n  useEffect(() => {\r\n    verificarLogin();\r\n  }, []);\r\n\r\n  // Função para fazer o login\r\n  const login = async (email, senha) => {\r\n    try {\r\n      const resposta = await fetch(`${API_URL}/login`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        credentials: 'include', // Garante que o cookie de sessão seja enviado\r\n        body: JSON.stringify({ email, senha }),\r\n      });\r\n\r\n      const data = await resposta.json();\r\n      if (data.logado) {\r\n        setUsuario(data.usuario);\r\n      } else {\r\n        console.error('Falha no login');\r\n      }\r\n    } catch (erro) {\r\n      console.error('Erro no login:', erro);\r\n    }\r\n  };\r\n\r\n  // Função para fazer o logout\r\n  const logout = () => {\r\n    setUsuario(null);\r\n    fetch(`${API_URL}/logout`, {\r\n      method: 'POST',\r\n      credentials: 'include', // Garante que o cookie de sessão seja enviado\r\n    });\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ usuario, login, logout, carregando, autorizacao }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\n// Hook para consumir o contexto\r\nexport const useAuth = () => {\r\n  return useContext(AuthContext);\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}